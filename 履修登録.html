<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>履修登録システム</title>
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    * {
      box-sizing: border-box;
    }
    body {
      font-family: 'Noto Sans JP', sans-serif;
      margin: 0;
      padding: 0;
      background: #f0f2f5;
      color: #333;
    }
    header {
      background: #4a90e2;
      color: #fff;
      padding: 20px;
      text-align: center;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      position: sticky;
      top: 0;
      z-index: 10;
    }
    header h1 {
      margin: 0;
      font-size: 28px;
      font-weight: 700;
    }
    header p {
      margin: 5px 0 0;
      font-size: 16px;
    }
    .container {
      max-width: 1100px;
      margin: 30px auto;
      background: #fff;
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    .department {
      margin-top: 30px;
      padding-bottom: 20px;
      border-bottom: 1px solid #e0e0e0;
    }
    .department:last-child {
      border-bottom: none;
    }
    .department h2 {
      font-size: 24px;
      margin-bottom: 10px;
      border-left: 5px solid #4a90e2;
      padding-left: 10px;
    }
    .department h3 {
      font-size: 20px;
      margin: 20px 0 10px;
      color: #4a90e2;
    }
    .course {
      display: flex;
      align-items: flex-start;
      margin-bottom: 12px;
      padding: 8px;
      border-radius: 4px;
      transition: background 0.3s;
    }
    .course:hover {
      background: #f9f9f9;
    }
    .course input[type="checkbox"] {
      margin-right: 12px;
      transform: scale(1.2);
      cursor: pointer;
    }
    .course label {
      cursor: pointer;
    }
    .course label strong {
      font-size: 16px;
    }
    .course label small {
      display: block;
      margin-top: 4px;
      color: #666;
      font-size: 14px;
    }
    .warning {
      color: #e74c3c;
      font-weight: 500;
      margin-top: 10px;
      text-align: center;
    }
    .output-section {
      margin-top: 30px;
      text-align: center;
    }
    .btn {
      background: #4a90e2;
      color: #fff;
      border: none;
      padding: 12px 24px;
      font-size: 16px;
      border-radius: 4px;
      cursor: pointer;
      transition: background 0.3s;
      margin: 0 8px;
    }
    .btn:hover {
      background: #357ABD;
    }
    a.download-link {
      text-decoration: none;
      font-size: 16px;
      color: #4a90e2;
      font-weight: 500;
      display: inline-block;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <header>
    <h1>履修登録システム</h1>
    <p>選択された科目数：<span id="selectedCount">0</span> / 12</p>
  </header>
  <div class="container">
    <p>以下の科目から12科目まで選択してください。</p>
    <!-- 科目一覧表示領域 -->
    <div id="courseList"></div>
    <p class="warning" id="warningMsg" style="display:none;">※12科目を超える選択はできません。</p>
    <div class="output-section">
      <button id="exportBtn" class="btn">CSV出力</button>
      <a id="downloadLink" class="download-link" style="display:none;" href="#" download="selected_courses.csv">CSVファイルをダウンロード</a>
    </div>
  </div>

  <script>
    // 全科目データ
    const courses = [
      //【呪歌学科】
      //■ 実践演奏
      { department: "呪歌学科", category: "実践演奏", title: "戦場音楽戦略（Strategic Combat Hymnology）", description: "戦況を判断し、『モラル』『アンビエント』を駆使して戦闘全体の命中を管理する手法を学ぶ。" },
      { department: "呪歌学科", category: "実践演奏", title: "精神操作呪歌論（Psychological Effects of Bardic Magic）", description: "『ララバイ』『クラップ』『ダル』などの強力な妨害呪歌の活用戦術。" },
      { department: "呪歌学科", category: "実践演奏", title: "抗魔旋律と魔法干渉（Anti-Magic Chants and Spell Resistance）", description: "『レジスタンス』『ブレイク』による魔法抵抗の強化・弱体の効果分析。" },
      { department: "呪歌学科", category: "実践演奏", title: "集団戦呪歌運用論（Group Battle Hymn Theory）", description: "多人数のバードによる合奏や、パーティ単位での支援戦術を体系化。" },
      { department: "呪歌学科", category: "実践演奏", title: "音響妨害戦術（Disruptive Acoustics in Combat）", description: "敵の指揮官や呪文詠唱者を妨害する音響戦略の技術と効果検証。" },

      //■ 応用演奏技術
      { department: "呪歌学科", category: "応用演奏技術", title: "終律増強研究実践（Advanced Research on Augmented Codas）", description: "強化終律による戦闘への影響と、最適な楽素管理の方法論。" },
      { department: "呪歌学科", category: "応用演奏技術", title: "特殊楽器戦術応用（Advanced Tactical Instrumentation）", description: "シンバルシールド、フィスタロッサムなどの特殊楽器の戦術的運用。" },
      { department: "呪歌学科", category: "応用演奏技術", title: "精密終律演奏応用（Precision Coda Performance）", description: "終律を確実に命中させる技術を磨き、常に安定したダメージを出せるようにする。" },
      { department: "呪歌学科", category: "応用演奏技術", title: "多重呪歌奏法（Multi-Harmony Techniques）", description: "ペットと共に呪歌を同時に複数展開し、味方への支援効果を最大化する戦術を研究する。" },
      { department: "呪歌学科", category: "応用演奏技術", title: "精密演奏制御基礎（Skilled Performance Control）", description: "呪歌の演奏成功率を最大限に引き上げ、戦闘中の演奏失敗を極力減らす技術を学ぶ。" },

      //■ 呪歌概論
      { department: "呪歌学科", category: "呪歌概論", title: "楽素研究概論（Research on Harmonic Energy Waves）", description: "楽素の蓄積・種類・消費のメカニズムと、それに基づく最適な戦闘プランニングを研究する。" },
      { department: "呪歌学科", category: "呪歌概論", title: "中級終律概論（Coda Theory and Performance Strength Analysis）", description: "レベル5終律の威力と奏力を理論的に解析し、最適な運用法を考察する。" },
      { department: "呪歌学科", category: "呪歌概論", title: "精神波動と幻惑効果（Mental Frequencies and Illusion Effects）", description: "呪歌が敵味方に与える心理的影響のメカニズムと実践活用を学ぶ。" },
      { department: "呪歌学科", category: "呪歌概論", title: "楽器工学基礎（Magical Instrument Engineering）", description: "楽器の設計とその戦術的応用について学ぶ。" },
      { department: "呪歌学科", category: "呪歌概論", title: "異次元音響学（Dimensional Acoustics）", description: "奈落の魔域や剣の迷宮における音響の影響を研究し、特殊環境下での呪歌の効果を検証する。" },

      //■ 音楽人類学・伝承学
      { department: "呪歌学科", category: "音楽人類学・伝承学", title: "多文化音楽学（Ethnomusicology of Other Races）", description: "エルフ・ドワーフ・リカント・その他種族の民族音楽とその影響を研究する。" },
      { department: "呪歌学科", category: "音楽人類学・伝承学", title: "呪歌歴史研究（Historical Bardic Studies）", description: "過去の偉大な吟遊詩人やその技術と戦術の再現を研究する。" },
      { department: "呪歌学科", category: "音楽人類学・伝承学", title: "英雄叙事詩と戦闘詩学（Heroic Epics and Battle Poetry）", description: "英雄伝や戦争歌の持つ文化的・心理的影響を分析する。" },
      { department: "呪歌学科", category: "音楽人類学・伝承学", title: "暗号詠唱法（Ciphered Hymnology）", description: "呪歌を用いた秘密通信技術とその歴史的使用例を学ぶ。" },

      //【鼓咆学部】
      //■ 指揮戦術学
      { department: "鼓咆学部", category: "指揮戦術学", title: "戦術鼓咆運用論Ⅰ（Advanced War Cry Tactics I）", description: "戦局に応じた鼓咆の選択と運用法を学ぶ基礎理論。" },
      { department: "鼓咆学部", category: "指揮戦術学", title: "士気管理と戦場心理学（Morale Management and Battlefield Psychology）", description: "兵士や冒険者の士気を管理し、敵の士気を削ぐ心理戦を実践する。" },
      { department: "鼓咆学部", category: "指揮戦術学", title: "陣率強化演習（Practical Training in Strategic Formations）", description: "陣率を活用した自己強化と集団戦闘への応用を実地訓練で習得する。" },
      { department: "鼓咆学部", category: "指揮戦術学", title: "先制戦術と布陣学（Initiative Tactics and Battlefield Deployment）", description: "先制判定の活用や開戦時の布陣選択、戦局に応じた展開方法を理論と実践で学ぶ。" },
      { department: "鼓咆学部", category: "指揮戦術学", title: "戦術的包囲と陣形学（Encirclement Strategies and Formation Analysis）", description: "集団戦闘における包囲戦術と陣形の変遷、戦略的活用法を学ぶ。" },

      //■ 軍略応用学
      { department: "鼓咆学部", category: "軍略応用学", title: "戦場適応戦術（Adaptive Warfare Tactics）", description: "戦闘中に変化する状況を判断し、リアルタイムで戦術を組み立てる技術を習得する。" },
      { department: "鼓咆学部", category: "軍略応用学", title: "大規模戦闘指揮論（Theory of Large-Scale Battle Command）", description: "小隊・中隊レベルでのウォーリーダーの統率技術を研究する。" },
      { department: "鼓咆学部", category: "軍略応用学", title: "戦略的撤退と持久戦術（Strategic Retreat and Endurance Tactics）", description: "戦況が不利な場合の撤退指示と長期戦での鼓咆・陣率管理を学ぶ。" },
      { department: "鼓咆学部", category: "軍略応用学", title: "軍師の知略と情報戦（Military Intelligence and Strategic Deception）", description: "偵察、偽情報戦、伏兵の活用など、軍略としての情報戦を習得する。" },
      { department: "鼓咆学部", category: "軍略応用学", title: "兵站と補給戦略（Logistics and Supply Chain in Warfare）", description: "持久戦に必要な物資管理や魔法・ポーションの供給・運用を学ぶ。" },

      //■ 高度支援技術
      { department: "鼓咆学部", category: "高度支援技術", title: "多重鼓咆運用実践（Multi-Layered War Cry Application）", description: "高度な鼓咆の組み合わせと複数バフ効果の最大化を演習する。" },
      { department: "鼓咆学部", category: "高度支援技術", title: "魔法支援戦術論（Magical Warfare Support Strategies）", description: "魔法戦における支援戦術、魔法使いとの連携と支援効果の最大化を学ぶ。" },
      { department: "鼓咆学部", category: "高度支援技術", title: "戦場回復と状態異常対策（Battlefield Recovery and Status Resistance）", description: "戦闘中の回復戦術や状態異常対策の実践戦略を学ぶ。" },
      { department: "鼓咆学部", category: "高度支援技術", title: "部隊間戦術連携演習（Tactical Coordination Between Squads）", description: "多部隊間での戦術協力と指揮官連携のケーススタディを実施する。" },

      //■ 戦場心理学
      { department: "鼓咆学部", category: "戦場心理学", title: "恐怖管理と勇気形成（Fear Suppression and Courage Development）", description: "恐怖による戦力低下を抑え、勇気を引き出す方法論を学ぶ。" },
      { department: "鼓咆学部", category: "戦場心理学", title: "極限状況下の指揮決断（Command Decision-Making Under Extreme Conditions）", description: "突発的な状況変化や戦況悪化の中での迅速な指揮判断を実戦演習する。" },
      { department: "鼓咆学部", category: "戦場心理学", title: "逆転戦術と士気回復（Comeback Strategies and Morale Recovery）", description: "崩壊寸前の軍勢を立て直し、逆転勝利を収める戦術シミュレーションを行う。" },

      //■ 軍事史・戦争社会学科
      { department: "鼓咆学部", category: "軍事史・戦争社会学科", title: "軍師戦術史概論（Introduction to the History of Military Strategy）", description: "戦術・戦略の歴史的変遷を概観し、ウォーリーダー技能の発展を考察する。" },
      { department: "鼓咆学部", category: "軍事史・戦争社会学科", title: "歴史的軍師研究（Studies on Legendary War Leaders）", description: "歴史上の名軍師の戦術とその応用を分析し、実戦での再現性を検証する。" },
      { department: "鼓咆学部", category: "軍事史・戦争社会学科", title: "種族別戦争戦略概論（Comparative Warfare Strategies of Different Races）", description: "各種族（人間、エルフ、ドワーフ、リカント）の戦争観と戦術の違いを研究する。" },
      { department: "鼓咆学部", category: "軍事史・戦争社会学科", title: "戦後処理と戦争倫理（Post-War Management and Ethics of Warfare）", description: "戦後の責任、復興支援、戦争倫理と指揮のバランスを考察する。" },

      //【練技学部】
      //■ 練体戦術学
      { department: "練技学部", category: "練体戦術学", title: "戦闘用練技の最適化（Optimization of Combat Enhancements）", description: "練技の組み合わせや発動順を最適化し、戦場で最大の効果を発揮する技術を学ぶ。" },
      { department: "練技学部", category: "練体戦術学", title: "練技の耐久戦術（Sustained Battle Tactics with Enhancements）", description: "長期戦を想定し、MP管理や効果時間延長を活用する戦術を習得する。" },
      { department: "練技学部", category: "練体戦術学", title: "極限状況下の練技応用（Applied Enhancements in Extreme Conditions）", description: "魔法封殺環境や異常状態下での練技活用を検証し、最適な選択肢を導く。" },
      { department: "練技学部", category: "練体戦術学", title: "特殊戦域における練技戦術（Enhancement Strategies in Specialized Environments）", description: "水中、寒冷地、高重力地帯など特殊環境下での練技有効性と適応方法を考察する。" },
      { department: "練技学部", category: "練体戦術学", title: "魔法戦との協調戦術（Coordination of Enhancements and Magic Combat）", description: "エンハンサーと魔法使いの連携によるバフ・デバフの相乗効果を学ぶ。" },

      //■ 練体戦闘理論
      { department: "練技学部", category: "練体戦闘理論", title: "練技と格闘技の融合（Fusion of Enhancements and Martial Arts）", description: "練体戦士が徒手格闘を最大限に活かす特化戦術を習得する。" },
      { department: "練技学部", category: "練体戦闘理論", title: "練体術と武器戦闘（Synergy of Enhancements and Weapon Combat）", description: "各種武器との適合性を考察し、最適な戦闘スタイルを構築する。" },
      { department: "練技学部", category: "練体戦闘理論", title: "戦闘持久力の鍛錬（Training for Combat Endurance）", description: "長時間戦闘に耐えるための練体法と実践技術を修得する。" },
      { department: "練技学部", category: "練体戦闘理論", title: "瞬発的練技発動（Instantaneous Activation of Enhancements）", description: "予備動作なしで即座に練技を発動する技術を研究し実践する。" },
      { department: "練技学部", category: "練体戦闘理論", title: "防御・回避向上技術（Techniques for Enhanced Defense and Evasion）", description: "練技を活用した防御・回避向上の理論と実践を学ぶ。" },

      //■ 生体練技科学
      { department: "練技学部", category: "生体練技科学", title: "練体生理学（Physiology of Enhancement Techniques）", description: "練技が肉体に与える影響を生理学・解剖学の観点から分析し、効果持続性や副作用を考察する。" },
      { department: "練技学部", category: "生体練技科学", title: "練体技術と神経筋制御（Enhancement Techniques and Neuromuscular Control）", description: "練技が神経伝達や筋肉動作に与える影響を研究し、動作制御と反応速度の向上を目指す。" },
      { department: "練技学部", category: "生体練技科学", title: "練技の老化抑制と寿命延長（Enhancement Techniques and Longevity）", description: "練技が細胞再生や老化抑制に与える影響を解析し、長期的な身体への作用を探求する。" },
      { department: "練技学部", category: "生体練技科学", title: "練技と生体ストレス（Enhancements and Physiological Stress）", description: "練技使用が心身に及ぼすストレス負荷と長期使用時の影響を検証する。" },
      { department: "練技学部", category: "生体練技科学", title: "異種族生理における練技適応研究（Enhancement Adaptation in Non-Human Physiology）", description: "各種族の生理特性に応じた練技の有効性と最適化を検証する。" },

      //■ 練技文化学
      { department: "練技学部", category: "練技文化学", title: "練技の歴史と進化（History and Evolution of Enhancements）", description: "練技の起源、歴史、技術の変遷を追い、最新理論との関係性を探求する。" },
      { department: "練技学部", category: "練技文化学", title: "未来の練体技術（Future Prospects in Enhancement Technology）", description: "次世代の練技技術や新たな戦術応用を予測し、可能性を模索する。" },
      { department: "練技学部", category: "練技文化学", title: "魔導練技の統合（Integration of Arcane Magic and Enhancement Techniques）", description: "練技と魔法の融合による新たな戦術・戦略の発展を研究する." },

      //【一般教養】
      //■ 環境適応学
      { department: "一般教養", category: "環境適応学", title: "地誌学と地図作成（Geography and Advanced Cartography）", description: "地形・地勢の変化を読み解き、地図作成や地理情報分析技術を修得する。" },
      { department: "一般教養", category: "環境適応学", title: "気象学と気候変動（Meteorology and Climate Change）", description: "気候変動の仕組みを学び、天候予測技術を高める。" },
      { department: "一般教養", category: "環境適応学", title: "都市設計と環境調整（Urban Planning and Environmental Management）", description: "都市設計技術を学び、防災・衛生・流通の仕組みを研究する。" },
      { department: "一般教養", category: "環境適応学", title: "持続可能な資源管理（Sustainable Resource Management）", description: "自然資源の適切な活用と保全、森林・鉱山・水資源の管理方法を探求する。" },
      { department: "一般教養", category: "環境適応学", title: "生態系と人間活動（Ecosystems and Human Interaction）", description: "野生動植物と人間社会の関係を学び、環境保全と開発のバランスを考える。" },

      //■ 身体運動学
      { department: "一般教養", category: "身体運動学", title: "動作解析と身体制御（Motion Analysis and Physical Control）", description: "人体の構造を理解し、無駄のない動作を実現する方法を探求する。" },
      { department: "一般教養", category: "身体運動学", title: "危機回避と受動運動（Risk Avoidance and Passive Movement Techniques）", description: "落下や衝撃を最小限に抑える技術で災害時の対応力を向上させる。" },
      { department: "一般教養", category: "身体運動学", title: "都市と自然における移動戦略（Urban and Natural Movement Strategies）", description: "都市や自然環境に適応した移動技術を学び、行動計画を策定する。" },
      { department: "一般教養", category: "身体運動学", title: "表現技術と身体言語（Expressive Techniques and Body Language）", description: "非言語コミュニケーションの技術を学び、異文化間の意思疎通や芸術表現に応用する." },
      { department: "一般教養", category: "身体運動学", title: "変装と印象操作（Disguise and Impression Management）", description: "服装・仕草・声の使い方を研究し、異なる社会階層や文化に溶け込む技術を習得する." },

      //■ 情報分析学
      { department: "一般教養", category: "情報分析学", title: "観察と記憶の強化（Observation and Memory Enhancement）", description: "精密な観察技術と記憶術を学び、正確な記録・分析能力を養う." },
      { department: "一般教養", category: "情報分析学", title: "異常認識と兆候解析（Anomaly Recognition and Sign Analysis）", description: "些細な違和感を察知し、環境や人物の変化を見極める技術を習得する." },
      { department: "一般教養", category: "情報分析学", title: "聴覚分析と音響学（Auditory Analysis and Acoustics）", description: "音の特性を学び、環境音や会話、反響を用いた情報収集技術を研究する." },
      { department: "一般教養", category: "情報分析学", title: "言語学と翻訳技術（Linguistics and Translation Studies）", description: "各地の言語構造を理解し、正確な翻訳と文化背景の解読を習得する." },
      { department: "一般教養", category: "情報分析学", title: "記録管理と歴史解析（Archival Studies and Historical Analysis）", description: "文献や碑文の記録整理・解読を通して、歴史や文化の研究を進める." },

      //■ 文明研究学
      { department: "一般教養", category: "文明研究学", title: "文明史と社会構造（Civilization History and Social Structures）", description: "古代から現代までの社会制度や文化発展、政治・経済の変遷を分析する." },
      { department: "一般教養", category: "文明研究学", title: "遺跡学と考古学（Archaeology and Ruins Studies）", description: "古代遺跡や建造物の構造、文化的背景、技術革新の歴史を考察する." },
      { department: "一般教養", category: "文明研究学", title: "貿易と経済の歴史（History of Trade and Economics）", description: "過去の交易路や経済システムを学び、現代の商業・産業との関係を分析する." },
      { department: "一般教養", category: "文明研究学", title: "伝承と神話の研究（Mythology and Folklore Studies）", description: "各地の伝承や神話の背景、文化形成における象徴的役割を探求する." },
      { department: "一般教養", category: "文明研究学", title: "芸術文化論（Theories of Artistic and Cultural Expression）", description: "絵画、彫刻、音楽、詩などの芸術表現が社会に与える影響と文化発展を分析する." },

      //■ 応用知識学
      { department: "一般教養", category: "応用知識学", title: "薬草学と生体化学（Herbalism and Biochemistry）", description: "植物由来の薬や毒の特性を研究し、医療や科学に応用する." },
      { department: "一般教養", category: "応用知識学", title: "健康管理と長寿研究（Health Management and Longevity Studies）", description: "生活習慣、食事、体調管理を学び、健康維持と寿命延長の理論を探求する." },
      { department: "一般教養", category: "応用知識学", title: "犯罪心理と法学（Criminal Psychology and Legal Studies）", description: "犯罪の動機や行動を分析し、法律や秩序の構築を考察する." },
      { department: "一般教養", category: "応用知識学", title: "財宝鑑定と市場経済（Treasure Appraisal and Market Economics）", description: "価値の変動、市場動向を研究し、財宝や貴金属の評価技術を学ぶ." },
      { department: "一般教養", category: "応用知識学", title: "建築と構造力学（Architecture and Structural Mechanics）", description: "建造物の耐久性や設計技術を研究し、安全で機能的な都市構築を目指す." }
    ];

    // 選択された科目数表示を更新する関数
    function updateSelectedCount() {
      const count = document.querySelectorAll("input[type='checkbox']:checked").length;
      document.getElementById("selectedCount").textContent = count;
    }

    // 学部・学科ごとにグループ化して表示する関数
    function renderCourses() {
      const courseListDiv = document.getElementById("courseList");
      courseListDiv.innerHTML = "";
      
      // 学部ごとにグループ化
      const grouped = courses.reduce((acc, course) => {
        if (!acc[course.department]) {
          acc[course.department] = [];
        }
        acc[course.department].push(course);
        return acc;
      }, {});
      
      // 学部ごとに表示
      for (const dept in grouped) {
        const deptDiv = document.createElement("div");
        deptDiv.className = "department";
        const deptTitle = document.createElement("h2");
        deptTitle.textContent = dept;
        deptDiv.appendChild(deptTitle);
        
        // 同一学部内でカテゴリごとにグループ化
        const groupedByCategory = grouped[dept].reduce((acc, course) => {
          if (!acc[course.category]) {
            acc[course.category] = [];
          }
          acc[course.category].push(course);
          return acc;
        }, {});
        
        for (const cat in groupedByCategory) {
          const catTitle = document.createElement("h3");
          catTitle.textContent = cat;
          deptDiv.appendChild(catTitle);
          
          groupedByCategory[cat].forEach((course, index) => {
            const courseDiv = document.createElement("div");
            courseDiv.className = "course";
            const checkbox = document.createElement("input");
            checkbox.type = "checkbox";
            checkbox.id = `${course.department}_${course.category}_${index}`;
            checkbox.addEventListener("change", (e) => {
              checkSelectionLimit(e);
              updateSelectedCount();
            });
            
            const label = document.createElement("label");
            label.htmlFor = checkbox.id;
            label.innerHTML = `<strong>${course.title}</strong>
                               <small>${course.description}</small>`;
            
            courseDiv.appendChild(checkbox);
            courseDiv.appendChild(label);
            deptDiv.appendChild(courseDiv);
          });
        }
        courseListDiv.appendChild(deptDiv);
      }
    }
    
    // 12科目を超える選択を制限
    function checkSelectionLimit(e) {
      const checked = document.querySelectorAll("input[type='checkbox']:checked");
      if (checked.length > 12) {
        e.target.checked = false;
        document.getElementById("warningMsg").style.display = "block";
        setTimeout(() => { document.getElementById("warningMsg").style.display = "none"; }, 2000);
      }
    }
    
    // CSV生成とダウンロード処理
    function exportCSV() {
      const checked = document.querySelectorAll("input[type='checkbox']:checked");
      if (checked.length === 0) {
        alert("科目が選択されていません。");
        return;
      }
      let csvContent = "科目名,学部,カテゴリ,説明\n";
      
      checked.forEach(checkbox => {
        const courseLabel = checkbox.nextSibling.textContent;
        const course = courses.find(c => c.title === courseLabel.trim().split("\n")[0]);
        if (course) {
          csvContent += `"${course.title}","${course.department}","${course.category}","${course.description}"\n`;
        }
      });
      
      const blob = new Blob([csvContent], { type: "text/csv;charset=utf-8;" });
      const url = URL.createObjectURL(blob);
      const downloadLink = document.getElementById("downloadLink");
      downloadLink.href = url;
      downloadLink.style.display = "inline-block";
    }
    
    document.getElementById("exportBtn").addEventListener("click", exportCSV);
    renderCourses();
    updateSelectedCount();
  </script>
</body>
</html>

